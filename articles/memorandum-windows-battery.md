---
title: "Windowsのバッテリー消耗率の調べ方"
emoji: "📓"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [windows]
published: true
---

# はじめに

どうも、ノートパソコンを1年でダメにしたアヤノです。
ノートパソコンをしばらく使っていると、「なんか最近バッテリーの減り早くない？」と思う瞬間、ありますよね。

そんな時は、Windwos公式のバッテリー診断レポート機能を使って見ましょう。
この機能を使うと、**設計容量・現在のフル充電容量・劣化率の推移**などバッテリーの現状を**OS内部のログ**から詳しく知る事が出来ます。

# TL;DR

- Windows は **ACPI と電源管理ログ** を使ってバッテリーの状態を常時記録している
- `powercfg /batteryreport` を実行すると、内部ログをもとにした **詳細なHTMLレポート** を出力できる
- レポートには **設計容量・フル充電容量・劣化率・履歴** がすべて載っている
- 劣化は「フル充電容量 ÷ 設計容量」でざっくり判断できる
- 「Recent usage」と「Capacity history」を読み解けば、**ハードウェアの劣化**か**ソフトウェアの異常消費**かを切り分けることができる

# Windowsのバッテリー診断レポートとは？仕組みと重要性

バッテリー診断レポートは、Windowsの電源管理機能が内部的に保持しているデータを、誰でも閲覧できるHTMLレポートにまとめて出力する**公式診断ツール**です。

![](/images/articles/memorandum-windows-battery/battery-report.png)

## レポートで分かる主要データ

この機能で生成されるレポートには、一般のPC設定画面では確認できない下記のようなバッテリーの詳細な状況が書かれます。

| 項目名 | 説明 |
| :--- | :--- |
| **Design Capacity**（設計容量） | 新品時の理論的な最大容量。メーカーが設定した基準値です。 |
| **Full Charge Capacity**（現在の満充電容量） | 現時点で最大まで充電できる容量。バッテリーの劣化が進むと減少します。 |
| **Cycle Count**（充放電サイクル数） | バッテリーを0%から100%まで充電した回数の累計。※機種やBIOSの実装に依存し、表示されない場合もあります。 |
| **Recent usage**（最近の利用ログ） | 直近数日間の残量変化、電源ON/OFF、スリープ遷移を時系列で記録したデータ。異常消費の特定に役立ちます。 |
| **Capacity history**（容量推移） | 設計容量に対する満充電容量が、過去数ヶ月でどのように変化したかを示すグラフ。劣化のペース分析に使われます。 |
| **Battery life estimates**（推定稼働時間） | Windowsが実測ベースで算出した、バッテリー駆動時間の推定値の推移。 |

## Windowsがバッテリー状態を把握できる理由

バッテリー診断レポート機能で分かる情報は、Windowsが単にバッテリー残量を読み取っているわけではなく、ハードウェアとOSが密接に連携し、ログを継続的に記録しています。

| 仕組み | 役割と動作 | 重要性 |
| :--- | :--- | :--- |
| **ACPI** (Advanced Configuration and Power Interface) | バッテリーの**設計容量、現在容量、温度**などの静的な情報をOSに提供する国際標準規格。 | **設計容量**や**Cycle Count**は、この規格の実装を通じて取得されます。 |
| **Embedded Controller (EC)** | バッテリーセルを物理的に監視しているマイクロコントローラー。ACPIを通じてOSにデータを伝達します。 | **ハードウェアのリアルタイムな状態**を把握する実体です。 |
| **Windows Power Management** / **イベントログ** | OS側で、**充放電量、画面ON時間、スリープ/復帰のタイミング**などを継続的な動的ログとして記録します。 | **異常消費**や**過去の使用履歴**の解析に不可欠です。 |

# バッテリー診断レポートの生成方法

バッテリー診断レポートの生成は、PowerShellまたはコマンドプロンプトで、下記のコマンドを実行するだけできます。
生成されたレポートはbattery-report.htmlというファイル名で保存され、ブラウザで内容を確認できます。

```powershell
# 任意の場所で実行する
powercfg /batteryreport
```
# レポート項目の詳細解説と正しい読み方

生成されたレポートには、いくつかのセクションがあります。ここでは、特に**バッテリーの健康状態**と**異常消費の原因特定**の状況確認に必要な項目を解説します。

## 1．Installed batteries（基本情報と劣化率の判断）

Installed batteriesは、バッテリーの「健康状態」を判断する最も重要なセクションです。このセクションでは、下記の情報を確認できます。

| 項目 | 説明 | 判断のポイント |
| :--- | :--- | :--- |
| **Design Capacity** | 新品時の理論的な最大容量（メーカー設定値） | 常にこの値が100%の基準となります。 |
| **Full Charge Capacity** | 現時点で満充電できる最大容量 | **劣化が進むほど、この値が減少します。** |
| **Cycle Count** | 累計の充放電回数 | バッテリーの「使用頻度」の目安になります。 |

ここで確認できる情報を使うことで、バッテリーの劣化率が算出出来ます。基本的には下の表のように、劣化率が50%を超えると買い替えを検討したほうが良いです。

$$\text{劣化率} = \frac{\text{Full Charge Capacity}}{\text{Design Capacity}} \times 100$$

| 劣化率の目安 | バッテリーの状態 |
| :--- | :--- |
| **90〜100%** | ほぼ新品の状態、自然な初期劣化の範囲内。 |
| **80% 前後** | 軽度の自然劣化。通常の使用で体感的な影響は少ない。 |
| **70% 以下** | 明らかな劣化。稼働時間が体感で短くなったと感じ始めるライン。 |
| **50% 以下** | 寿命レベル。交換を強く推奨される状態。 |

## 2．Recent usage（直近の利用ログから異常を特定）

Recent usageでは、過去数日〜数週間の**残量変化、電源状態、スリープ/アクティブ**の遷移が確認できます。これを見ることで**異常消費の原因特定**がしやすくなります。
下記のような異常消費であれば、以下のような原因が考えられます。

- **スリープ中に残量が急激に減っている**
  - Modern Standby（モダンスタンバイ）の暴走や、バックグラウンドでのネットワーク監視などが疑われます。
- **AC接続中なのに、バッテリー残量がわずかに減っている**
  - PCが高負荷で、ACアダプターからの給電量を超えた電力が必要になっている（高負荷ゲームや動画編集時）か、または**ドライバの不具合**による放電バグが考えられます。
- **特定の時間帯にだけ残量が急降下している**
  - その時間帯に起動していた高負荷プロセス（アプリ、サービス）が異常消費を起こしている可能性が高いです。

## 3．Capacity history（容量推移グラフで劣化のペースを分析）

Capacity historyは、過去数ヶ月にわたり、**現在の満充電容量がどのように変化したか**を記録しています。これは*劣化の「ペース」が正常か異常かを判断するのに役立ちます。

- **正常な劣化**：時間をかけて、**緩やかに少しずつ**容量が下がっていく。
-  **異常な劣化**：特定の月を境に**急落**している。
   -   **高温環境下での酷使**、**極端なフル放電**、または**バッテリー制御チップの異常**など、物理的な問題が強く疑われます。

## 4．Battery life estimates（推定稼働時間）

Battery life estimatesは、Windowsが**過去の使用実績**に基づいて算出した「**実働時間の推移**」です。

  * **Design Capacity**（新品時の推定値）と**Full Charge Capacity**（現在の推定値）を比較することで、**新品時と比べてどれだけ稼働時間が短くなったか**を数値で把握できます。
  * 体感的な「バッテリー持ちの悪さ」を客観的な数値で裏付けるデータとなります。


# バッテリー持ちが悪い原因の切り分け方

バッテリーの稼働時間が短くなる原因は、大きく分け**て「バッテリーの物理的な劣化（ハードウェア）**」と「**電力消費の多いプログラムの動作（ソフトウェア）**」の2つに分類できます。ッテリー診断レポート機能の結果を基に、どちらが主な原因であるかの切り分けができます。

## ハードウェア（バッテリーセル）の劣化が原因

「Installed batteries」と「Capacity history」セクションを確認すると、ハードウェア起因のバッテリー劣化か判断できます。これらのセクションは、バッテリーそのものの**寿命**を判断するために使えて、これらの値が悪い場合は、PCの使い方に関わらずバッテリーが本来持てる電力量が減っている状態になります。

| 診断項目 | 判断基準 | 結論と対策 |
| :--- | :--- | :--- |
| **Installed batteries** | **Full Charge Capacity**が**Design Capacity**より**20%以上**低い場合。 | バッテリーセル自体の**寿命**が近づいています。**満充電できる容量が新品時の80%以下**に低下しており、交換を検討する段階です。 |
| **Capacity history** | グラフが**右肩下がり**で推移している、または特定の時点で**急落**している。 | **物理的な劣化**が進行している証拠です。急落は、**高温**での使用や**過度な充放電**など、バッテリーに大きなストレスがかかったことを示唆します。 |

## ソフトウェア（OS・アプリ）による異常消費が原因

バッテリーの劣化はそれほど進んでいないのに、なぜかバッテリーの持ちが悪い、という場合は、特定のアプリや機能が大量の電力を消費しているソフトウェア要因が疑われます。この場合、「Recent usage」セクションで異常な消費パターンを探すと良いです。

| 診断項目 | 判断基準 | 結論と対策 |
| :--- | :--- | :--- |
| **Recent usage** | グラフ上で、**「Active（利用中）」**や**「Connected Standby（スリープ）」**時に**急激な残量減少**が見られる。 | 特定の時間帯に**CPU/GPU高負荷アプリ**が裏で動作しているか、**バックグラウンドサービス**が暴走している可能性があります。タスクマネージャーやWindowsの電力使用量設定を確認し、原因となるプロセスを特定・停止する必要があります。 |

# おまけ：Modern Standby問題（スリープ中の異常消費）

ノートPCに多く搭載されている**Modern Standby（モダンスタンバイ）**機能は、従来のスタンバイ（S3）よりも高速な復帰を可能にしますが、その代わりにスリープ中も**ネットワーク接続を維持し、一部のタスクをバックグラウンドで実行**します。これにより、予期せぬ電力消費が発生することがあります。

- **症状**: PCを閉じてスリープさせたはずなのに、数時間後に開くとバッテリーが大幅に減っている。
- **Recent usageでの見分け方**:
  -  State（状態）が`Connected Standby`（ネットワークに接続された状態のスリープ）になっている時間帯に、**Remaining Capacity（残り容量）が急激に減り続けている**場合、モダンスタンバイの制御に問題が発生している可能性が極めて高いです。
  -  この現象が確認された場合、Windowsの電源設定やネットワークアダプターの設定を見直す必要があります。
-  **Battery life estimatesでの見分け方**:
   -  Full Charge Capacity（バッテリーの最大容量）の数値が横ばいであるにも関わらず、特定の期間を境にEstimated life at full charge（満充電時の推定稼働時間）が急に短縮されている場合、モダンスタンバイ中のバックグラウンドタスクが急増したなど、**OS側の消費電力が増加**していることがわかります。

# まとめ
**バッテリー診断レポート**は、Windowsに標準搭載された非常に強力で便利なバッテリーの総合診断ツールです。これを使うことで下記の情報が確認できます。

1.  **劣化率**を正確に把握する。
2.  **異常消費**を時系列ログから特定する。
3.  **劣化のペース**が正常か異常かを分析する。

「最近バッテリーがすぐ切れる気がする…」と感じたら、まずは`powercfg /batteryreport`を実行して、客観的な数字を確認してみてください。